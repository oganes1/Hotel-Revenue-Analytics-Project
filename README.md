# üè® Hotel Revenue Analytics Project

> **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—ã—Ä—É—á–∫–∏ –æ—Ç–µ–ª—è —Å —Ä–∞—Å—á—ë—Ç–æ–º —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏, –æ—Ç–º–µ–Ω –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–∞–Ω–∞–ª–æ–≤ –ø—Ä–æ–¥–∞–∂**

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û –ø—Ä–æ–µ–∫—Ç–µ](#-–æ-–ø—Ä–æ–µ–∫—Ç–µ)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö)
3. [–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (KPIs)](#-–∫–ª—é—á–µ–≤—ã–µ-–º–µ—Ç—Ä–∏–∫–∏-kpis)
4. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
5. [–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã](#-–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ-–∑–∞–ø—Ä–æ—Å—ã)
6. [–ò–Ω—Å–∞–π—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#-–∏–Ω—Å–∞–π—Ç—ã-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)
7. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)

---

## üìä –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –¥–ª—è –æ—Ç–µ–ª—å–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –≥–æ–¥–∞ (2018‚Äì2020). –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –æ—Ü–µ–Ω–∫–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –±–∏–∑–Ω–µ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã—Ä—É—á–∫–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π, —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ —Å —É—á—ë—Ç–æ–º:

- ‚úÖ –ö–æ–º–∏—Å—Å–∏–π –∫–∞–Ω–∞–ª–æ–≤ –ø—Ä–æ–¥–∞–∂  
- ‚úÖ –í—ã—Ä—É—á–∫–∏ –æ—Ç –ø–∏—Ç–∞–Ω–∏—è (F&B)  
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç–∞ –æ—Ç–º–µ–Ω –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π  
- ‚úÖ –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤  

**C—Ç–µ–∫:**
- `MS SQL Server`

---
## –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ MS SQL Server 
–í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å, –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö "Project", –∫—É–¥–∞ –¥–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏–∑ Excel —Ñ–∞–π–ª–∞

<img width="333" height="329" alt="image" src="https://github.com/user-attachments/assets/b3f1d113-9dd8-44bc-a6c8-b762fce80d7c" />



## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–∞–ø–∏—Å–µ–π |
|---------|----------|---------|
| `sale_2018` | –î–∞–Ω–Ω—ã–µ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è—Ö –∑–∞ 2018 –≥–æ–¥ | ~22 000 |
| `sale_2019` | –î–∞–Ω–Ω—ã–µ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è—Ö –∑–∞ 2019 –≥–æ–¥ | ~79 000 |
| `sale_2020` | –î–∞–Ω–Ω—ã–µ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è—Ö –∑–∞ 2020 –≥–æ–¥ | ~40 000 |
| `market_segment` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∏—Å—Å–∏–π –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º | 8 |
| `meal_cost` | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–∏—Ç–∞–Ω–∏—è | 5 |

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö `#all_sales`

```sql
CREATE TABLE #all_sales (
    hotel                       VARCHAR(20),
    is_canceled                 INT,
    lead_time                   INT,
    arrival_date_year           INT,
    arrival_date_month          VARCHAR(10),
    arrival_date_week_number    INT,
    arrival_date_day_of_month   INT,
    stays_in_weekend_nights     INT,
    stays_in_week_nights        INT,
    adults                      INT,
    children                    INT,
    babies                      INT,
    meal                        VARCHAR(10),
    country                     VARCHAR(10),
    market_segment              VARCHAR(20),
    distribution_channel        VARCHAR(20),
    is_repeated_guest           INT,
    previous_cancellations      INT,
    previous_bookings_not_canceled INT,
    reserved_room_type          VARCHAR(1),
    assigned_room_type          VARCHAR(1),
    booking_changes             INT,
    deposit_type                VARCHAR(10),
    agent                       INT,
    company                     INT,
    days_in_waiting_list        INT,
    customer_type               VARCHAR(20),
    adr                         DECIMAL(10,2),
    required_car_parking_spaces INT,
    total_of_special_requests   INT,
    reservation_status          VARCHAR(10),
    reservation_status_date     DATETIME
);
```

### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

**`market_segment`** ‚Äî –∫–æ–º–∏—Å—Å–∏–∏ –∫–∞–Ω–∞–ª–æ–≤ –ø—Ä–æ–¥–∞–∂:

| market_segment | Discount |
|----------------|----------|
| Direct | 0.10 |
| Corporate | 0.15 |
| Online TA | 0.30 |
| Offline TA/TO | 0.30 |
| Complementary | 1.00 |

**`meal_cost`** ‚Äî —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞:

| meal | Cost |
|------|------|
| BB | 12.99 |
| HB | 17.99 |
| FB | 21.99 |
| SC | 35.00 |

---

## üìà –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (KPIs)

| –ú–µ—Ç—Ä–∏–∫–∞ | –§–æ—Ä–º—É–ª–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|
| **Cancellation Rate** | `–û—Ç–º–µ–Ω—ë–Ω–Ω—ã–µ / –í—Å–µ–≥–æ √ó 100` | –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–º–µ–Ω –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π |
| **Gross Revenue** | `ADR √ó –ù–æ—á–∏` | –í–∞–ª–æ–≤–∞—è –≤—ã—Ä—É—á–∫–∞ –Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞ |
| **Net Revenue** | `Gross ‚àí –ö–æ–º–∏—Å—Å–∏—è + F&B` | –ß–∏—Å—Ç–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç–µ–ª—è |
| **ADR** | `–í—ã—Ä—É—á–∫–∞ / –ù–æ—á–∏` | –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∑–∞ –Ω–æ—á—å |
| **ALOS** | `–ù–æ—á–∏ / –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è` | –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è |
| **Net Retention Ratio** | `Net / Gross` | –î–æ–ª—è —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –≤—ã—Ä—É—á–∫–∏ |

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–ò–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ Excel, –±—ã–ª–æ —Ä–µ—à–µ–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∏—Ö –∫ –±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–º —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö, –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è Alter table. 
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ, –Ω—É–∂–Ω–æ –±—ã–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è "Null" –≤ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö Null. 
```sql
USE [Project];

-- –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü 2018‚Äì2020)
ALTER TABLE sale_2018 ALTER COLUMN hotel VARCHAR(20);
ALTER TABLE sale_2018 ALTER COLUMN is_canceled INT;
-- ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è)

-- –û—á–∏—Å—Ç–∫–∞ NULL-–∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ Excel
UPDATE sale_2018 SET company = NULLIF(company, 'NULL');
-- ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è)
```

### 2. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –≥–æ–¥–∞

```sql
SELECT * INTO #all_sales FROM (
    SELECT * FROM sale_2018 UNION ALL
    SELECT * FROM sale_2019 UNION ALL
    SELECT * FROM sale_2020
) AS t;
```

### 3. –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ [`queries.sql`](./queries.sql). –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–æ —Å–µ–∫—Ü–∏—è–º.

---

## üîç –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã

### 1. –î–∏–Ω–∞–º–∏–∫–∞ –º–µ—Ç—Ä–∏–∫ –æ—Ç–µ–ª—è –ø–æ –≥–æ–¥–∞–º (YoY)

```sql
WITH YearlyMetrics AS (
    SELECT 
        arrival_date_year AS year,
        COUNT(*) AS total_bookings,
        SUM(CASE WHEN is_canceled = 1 THEN 1 ELSE 0 END) AS canceled_bookings,
        ROUND(CAST(SUM(CASE WHEN is_canceled = 1 THEN 1 ELSE 0 END) AS DECIMAL(10,2)) / COUNT(*) * 100, 0) AS cancellation_rate_pct,
        SUM(CASE WHEN is_canceled = 0 THEN (stays_in_weekend_nights + stays_in_week_nights) * adr ELSE 0 END) AS total_revenue,
        ROUND(AVG(CASE WHEN is_canceled = 0 THEN adr ELSE NULL END), 0) AS avg_adr,
        ROUND(AVG(CASE WHEN is_canceled = 0 THEN (stays_in_weekend_nights + stays_in_week_nights) ELSE NULL END), 0) AS avg_length_of_stay
    FROM #all_sales
    GROUP BY arrival_date_year
)
SELECT 
    year,
    total_bookings,
    canceled_bookings,
    cancellation_rate_pct,
    ROUND(total_revenue, 0) AS total_revenue,
    avg_adr,
    avg_length_of_stay,
    -- –í—ã—Ä—É—á–∫–∞ –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ–¥–∞ (LAG)
    ROUND(LAG(total_revenue) OVER (ORDER BY year), 0) AS prev_year_revenue,
    -- –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
    ROUND(total_revenue - LAG(total_revenue) OVER (ORDER BY year), 0) AS revenue_change_abs,
    -- –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ YoY (–∫–ª—é—á–µ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞)
    ROUND(
        (total_revenue - LAG(total_revenue) OVER (ORDER BY year)) * 100.0 / 
        NULLIF(LAG(total_revenue) OVER (ORDER BY year), 0), 
        2
    ) AS revenue_change_yoy_pct
FROM YearlyMetrics
ORDER BY year;
```

<img width="1040" height="114" alt="image" src="https://github.com/user-attachments/assets/2aac2026-0445-4318-ba2f-86b94973392f" />

–í—ã–≤–æ–¥—ã: 
1. –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–º–µ–Ω –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ —Ç—Ä–µ—Ö –ª–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–π - 37% 
2. –í 2019 –≥–æ–¥—É –≤—ã—Ä—É—á–∫–∞ —Ä–µ–∑–∫–æ –ø–æ–¥–Ω—è–ª–∞—Å—å –Ω–∞ 259%, –æ–¥–Ω–∞–∫–æ –≤ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≥–æ–¥—É —É–ø–∞–ª–∞ –Ω–∞ 39%
3. –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ –Ω–æ—á—å –∑–∞ 3 –≥–æ–¥–∞ –≤—ã—Ä–æ—Å–ª–∞ —Å 89 –¥–æ 111 $.  


### 2. –î–∏–Ω–∞–º–∏–∫–∞ –º–µ—Ç—Ä–∏–∫ –ø–æ —Ç–∏–ø–∞–º –æ—Ç–µ–ª–µ–π

```sql
Select arrival_date_year, hotel as type_hotel, 
        COUNT(*) AS total_bookings,
        SUM(CASE WHEN is_canceled = 1 THEN 1 ELSE 0 END) AS canceled_bookings,
        ROUND(CAST(SUM(CASE WHEN is_canceled = 1 THEN 1 ELSE 0 END) AS DECIMAL(10,2)) / COUNT(*) * 100, 0) AS cancellation_rate_pct,
        SUM(CASE WHEN is_canceled = 0 THEN (stays_in_weekend_nights + stays_in_week_nights) * adr ELSE 0 END) AS total_revenue,
        ROUND(AVG(CASE WHEN is_canceled = 0 THEN adr ELSE NULL END), 0) AS avg_adr,
        ROUND(AVG(CASE WHEN is_canceled = 0 THEN (stays_in_weekend_nights + stays_in_week_nights) ELSE NULL END), 0) AS avg_length_of_stay
FROM #all_sales
GROUP BY arrival_date_year,hotel
ORDER BY arrival_date_year
```

<img width="788" height="145" alt="image" src="https://github.com/user-attachments/assets/9de75ae3-6a36-4db9-a302-143adb154a74" />

–í—ã–≤–æ–¥—ã: 
1. –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ—Ç–µ–ª–µ–π –≤ –¥–æ–ª–µ –≤—ã—Ä—É—á–∫–∏ –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π - –æ—Ç–µ–ª–∏ –≤ —á–µ—Ä—Ç–µ –≥–æ—Ä–æ–¥–∞.
2. –£ –æ—Ç–µ–ª–µ–π –≤ —á–µ—Ä—Ç–µ –≥–æ—Ä–æ–¥–∞ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–º–µ–Ω –≤—ã—à–µ –ø–æ—á—Ç–∏ –≤ 2 —Ä–∞–∑–∞, —á–µ–º —É resort –æ—Ç–µ–ª–µ–π.
3. –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ –Ω–æ—á—å –∏ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –æ—Ç–¥—ã—Ö–∞ –≤—ã—à–µ —É resort –æ—Ç–µ–ª–µ–π.

### 3. –ß–∏—Å—Ç–∞—è –≤—ã—Ä—É—á–∫–∞ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º (Net Retention)

```sql
WITH SegmentFinancials AS (
    SELECT 
        s.market_segment,
        s.is_canceled,
        CAST(s.adr AS DECIMAL(18,4)) * (s.stays_in_weekend_nights + s.stays_in_week_nights) AS gross_rev,
        CAST(s.adr AS DECIMAL(18,4)) * (s.stays_in_weekend_nights + s.stays_in_week_nights) * ISNULL(ms.Discount, 0) AS commission,
        ISNULL(mc.Cost, 0) * (s.adults + s.children) * (s.stays_in_weekend_nights + s.stays_in_week_nights) AS fb_rev
    FROM #all_sales s
    LEFT JOIN market_segment ms ON s.market_segment = ms.market_segment
    LEFT JOIN meal_cost mc ON s.meal = mc.meal
)
SELECT 
    market_segment,
    SUM(CASE WHEN is_canceled = 0 THEN gross_rev ELSE 0 END) AS total_gross_revenue,
    SUM(CASE WHEN is_canceled = 0 THEN (gross_rev - commission + fb_rev) ELSE 0 END) AS total_net_revenue,
    -- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã—Ä—É—á–∫–∏ (Net / Gross)
    -- –ò—Å–ø–æ–ª—å–∑—É–µ–º DECIMAL(18,6) –∏ NULLIF –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
    CAST(
        SUM(CASE WHEN is_canceled = 0 THEN (gross_rev - commission + fb_rev) ELSE 0 END) AS DECIMAL(18,6)
    ) / NULLIF(
        CAST(SUM(CASE WHEN is_canceled = 0 THEN gross_rev ELSE 0 END) AS DECIMAL(18,6)), 
        0
    ) AS net_retention_ratio
FROM SegmentFinancials
Where market_segment <> 'Complementary'
GROUP BY market_segment
ORDER BY net_retention_ratio DESC;
```
<img width="488" height="167" alt="image" src="https://github.com/user-attachments/assets/4171ef8b-6178-473d-b70a-715ac6cce1b3" />

–í—ã–≤–æ–¥—ã: 
1. –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ—Ç–µ–ª–µ–π –≤ –¥–æ–ª–µ –≤—ã—Ä—É—á–∫–∏ –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π - –æ—Ç–µ–ª–∏ –≤ —á–µ—Ä—Ç–µ –≥–æ—Ä–æ–¥–∞.
2. –£ –æ—Ç–µ–ª–µ–π –≤ —á–µ—Ä—Ç–µ –≥–æ—Ä–æ–¥–∞ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–º–µ–Ω –≤—ã—à–µ –ø–æ—á—Ç–∏ –≤ 2 —Ä–∞–∑–∞, —á–µ–º —É resort –æ—Ç–µ–ª–µ–π.
3. –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ –Ω–æ—á—å –∏ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –æ—Ç–¥—ã—Ö–∞ –≤—ã—à–µ —É resort –æ—Ç–µ–ª–µ–π.

### 4. –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –ø–æ –º–µ—Å—è—Ü–∞–º

```sql
WITH MonthlyStats AS(
    SELECT 
        
        arrival_date_month,
        -- –ú–∞–ø–ø–∏–Ω–≥ –º–µ—Å—è—Ü–µ–≤ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        CASE arrival_date_month
            WHEN 'January' THEN 1 WHEN 'February' THEN 2 WHEN 'March' THEN 3
            WHEN 'April' THEN 4 WHEN 'May' THEN 5 WHEN 'June' THEN 6
            WHEN 'July' THEN 7 WHEN 'August' THEN 8 WHEN 'September' THEN 9
            WHEN 'October' THEN 10 WHEN 'November' THEN 11 WHEN 'December' THEN 12
        END AS month_num,
        COUNT(*) AS bookings,
        SUM(CASE WHEN is_canceled = 0 THEN (stays_in_weekend_nights + stays_in_week_nights) * adr ELSE 0 END) AS revenue,
        CAST(SUM(CASE WHEN is_canceled = 1 THEN 1 ELSE 0 END) AS DECIMAL(10,2)) / COUNT(*) * 100 AS cancel_rate
    FROM #all_sales
    GROUP BY  arrival_date_month
)
SELECT 
    arrival_date_month,
    bookings,
    revenue,
    cancel_rate
FROM MonthlyStats
ORDER BY month_num;
```
<img width="359" height="248" alt="image" src="https://github.com/user-attachments/assets/932f5b56-d863-4073-b50d-3e6189689a8e" />

–í—ã–≤–æ–¥—ã: 
1. –ü–∏–∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –∏—é–ª—å-–æ–∫—Ç—è–±—Ä—å 
2. –ù–∞–∏–±–æ–ª—å—à–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–º–µ–Ω –≤ –∞–ø—Ä–µ–ª–µ –∏ –∏—é–Ω–µ. 

### 5. –ê–Ω–∞–ª–∏–∑ –æ—Ç–º–µ–Ω –ø–æ —Ç–∏–ø—É –ø–∏—Ç–∞–Ω–∏—è

```sql
WITH Meals_year AS(
SELECT arrival_date_year,#all_sales.meal as meal, round(sum(Cost),2) as meal_sum
FROM #all_sales
LEFT JOIN meal_cost ON #all_sales.meal = meal_cost.meal
WHERE #all_sales.meal <> 'Undefined'
GROUP BY arrival_date_year,#all_sales.meal)

SELECT 
    arrival_date_year,
    meal,
    meal_sum,
    sum(meal_sum) over (partition by arrival_date_year, meal order by arrival_date_year)/
    sum(meal_sum) over (partition by arrival_date_year order by arrival_date_year) as meal_percentage
FROM Meals_year
```
<img width="335" height="249" alt="image" src="https://github.com/user-attachments/assets/884ad4a5-4ebd-456f-93ad-8bc20d865589" />

–í—ã–≤–æ–¥—ã: 
1. BB (Bed and Breakfast) - –∑–∞–Ω–∏–º–∞–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –¥–æ–ª—é –≤ –≤—ã—Ä—É—á–∫–µ, –æ–¥–Ω–∞–∫–æ –µ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏ —Å–Ω–∏–∑–∏–ª—Å—è —Å 71% –¥–æ 60%
2. SC (Self catering) - –∑–∞–Ω–∏–º–∞–ª –≤—Å–µ–≥–æ 4% –≤ 2018 –≥–æ–¥—É, –Ω–æ –≤—ã—Ä–æ—Å –¥–æ 27% –≤ 2020 –≥–æ–¥—É.

### 6. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
```sql
SELECT arrival_date_year,
    CASE WHEN is_repeated_guest = 1 THEN 'Repeated Guest' ELSE 'New Guest' END AS guest_type,
    COUNT(*) AS total_bookings,
    CAST(SUM(CASE WHEN is_canceled = 1 THEN 1 ELSE 0 END) AS DECIMAL(10,2)) / COUNT(*) * 100 AS cancellation_rate_pct,
    SUM(CASE WHEN is_canceled = 0 THEN (stays_in_weekend_nights + stays_in_week_nights) * adr ELSE 0 END) AS total_revenue,
    AVG(CASE WHEN is_canceled = 0 THEN (stays_in_weekend_nights + stays_in_week_nights) * adr ELSE NULL END) AS avg_revenue_per_booking
FROM #all_sales
GROUP BY arrival_date_year,is_repeated_guest
ORDER BY arrival_date_year;
```
<img width="633" height="145" alt="image" src="https://github.com/user-attachments/assets/0d0c1a31-9272-465f-bd66-60b7d8e37f99" />

–í—ã–≤–æ–¥—ã: 
1. –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã —Å—Ç–∞–ª–∏ –≥–æ—Ä–∞–∑–¥–æ —Ä–µ–∂–µ –æ—Ç–º–µ–Ω—è—é—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å 54% –¥–æ 4%)
2. –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –æ—Ç–º–µ–Ω—è—é—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–µ, —á–µ–º –Ω–æ–≤—ã–µ
3. –î–æ–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –≤—ã—Ä—É—á–∫–µ –æ—á–µ–Ω—å –º–∞–ª–∞

---

## üí° –ò–Ω—Å–∞–π—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### üî¥ –ü—Ä–æ–±–ª–µ–º—ã

| –ü—Ä–æ–±–ª–µ–º–∞ | –ú–µ—Ç—Ä–∏–∫–∞ | –í–ª–∏—è–Ω–∏–µ |
|----------|---------|---------|
| –í—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–º–µ–Ω | ~37% | –ü–æ—Ç–µ—Ä—è –≤—ã—Ä—É—á–∫–∏ |
| –í—ã—Å–æ–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏ OTA | 30% | –°–Ω–∏–∂–µ–Ω–∏–µ –º–∞—Ä–∂–∏ |
| –ù–∏–∑–∫–∞—è –¥–æ–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≥–æ—Å—Ç–µ–π | < 10% | –£–ø—É—â–µ–Ω–Ω–∞—è LTV |

### üü¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å | –î–µ–π—Å—Ç–≤–∏–µ | –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç |
|-------------|----------|------------------|
| –°—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ Direct-–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π | –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ | +15% Net Revenue |
| –ü–∞–∫–µ—Ç—ã —Å –ø–∏—Ç–∞–Ω–∏–µ–º (FB/HB) | –°–∫–∏–¥–∫–∞ 5% –ø—Ä–∏ –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ | ‚àí10% –æ—Ç–º–µ–Ω |
| –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ | ADR ‚Üë –≤ –ø–∏–∫ —Å–µ–∑–æ–Ω–∞ | +20% –≤—ã—Ä—É—á–∫–∞ |

### üìä –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **–ö–∞–Ω–∞–ª—ã —Å –≤—ã—Å–æ–∫–æ–π –∫–æ–º–∏—Å—Å–∏–µ–π** (Online TA, Offline TA) —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞ —É—Å–ª–æ–≤–∏–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤.
2. **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≥–æ—Å—Ç–∏** –∏–º–µ—é—Ç –Ω–∞ 40% –º–µ–Ω—å—à–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–º–µ–Ω ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞.
3. **–ü–∏—Ç–∞–Ω–∏–µ** —Å–Ω–∏–∂–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã –±—Ä–æ–Ω–∏ ‚Äî —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥–∞–∂—É –ø–∞–∫–µ—Ç–æ–≤.
4. **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å** –≤—ã—Ä–∞–∂–µ–Ω–∞ ‚Äî –≤ –Ω–∏–∑–∫–∏–π —Å–µ–∑–æ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å –∞–∫—Ü–∏–∏ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
hotel-revenue-analytics/
‚îú‚îÄ‚îÄ README.md                 # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ queries.sql               # –í—Å–µ SQL-–∑–∞–ø—Ä–æ—Å—ã
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ hotel_revenue_historical_full.xlsx        # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ schema.md            # –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ kpis.md              # –û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
‚îî‚îÄ‚îÄ reports/
    ‚îî‚îÄ‚îÄ 
```

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ê–≤—Ç–æ—Ä:** –û–≥–∞–Ω–µ—Å –ö–∞–∑–∞—Ä—è–Ω
**Email:**  


**‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!**


